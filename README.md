# syscalls

syscalls.py automatically dumps all x64 ntdll syscalls and saves them all to `ntdll_syscalls.py`

---

# why this exists

windows ntdll.dll exposes low level nt system calls that all higher level windows apis eventually use normally developers call functions like `openprocess` or `createfile` from `kernel32.dll` but these are just wrappers around nt system calls direct syscall usage allows you to

* bypass user mode hooks (some security products hook api functions to monitor or block behavior using direct syscalls avoids these hooks)
* improve stealth for research or security testing (useful for red teamers, malware analysis and security researchers)
* learn windows internals

this project automates dumping all x64 ntdll syscalls into a python dictionary (`ntdll_syscalls.py`) so you can reference syscall numbers directly without manual reverse engineering

---

# how it works

1. load `ntdll.dll` in memory using `ctypes.windll.kernel32.getmodulehandlew`
2. parse pe headers read the dos header and nt headers to locate the export table
3. enumerate exported functions filter for functions starting with `nt`
4. read syscall numbers scan the first bytes of each `nt*` function for `mov eax, imm32` instructions x64 convention for syscalls
5. dump to python dictionary automatically generates `ntdll_syscalls.py` in this format

```python
# autogenerated ntdll syscall stubs
import ctypes

syscalls = {}

syscalls['NtOpenProcess'] = 0x23
syscalls['NtCreateFile'] = 0x55
syscalls['NtQueryInformationProcess'] = 0x26
syscalls['NtClose'] = 0x0f
```

---

# how to use

```python
from ntdll_syscalls import syscalls

# get syscall number for ntopenprocess
ntopen_number = syscalls['NtOpenProcess']
print(f"ntopenprocess syscall number: {hex(ntopen_number)}")
```

from here you can use tools like `ctypes` or inline assembly to directly invoke syscalls in python or c

---

# notes / caveats

* this script only works on x64 windows
* syscall numbers can change between windows versions always regenerate `ntdll_syscalls.py` on the target system
* direct syscalls are low level operations misuse can crash your program or the system
* using this script while you're playing a game that uses an anticheat (user-mode or kernel-level) may get you banned
* this script might trigger your antivirus if it's extremely strict, if you want to use it, either add an exclusion or use it on a vm with the same build number
